<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Хогвартс Кликер</title>
<link href="https://fonts.googleapis.com/css2?family=MedievalSharp&display=swap" rel="stylesheet" />
<style>
  body {
    font-family: 'MedievalSharp', cursive;
    background: url('images/background.jpeg') no-repeat center center fixed;
    background-size: cover;
    color: #fff;
    margin: 0; padding: 20px;
    user-select: none;
    text-align: center;
  }
  h1, h2 {
    text-shadow: 2px 2px 5px #000;
  }
  #counter {
    font-size: 28px;
    margin-bottom: 20px;
    font-weight: bold;
    text-shadow: 1px 1px 3px #000;
  }
  #wand {
    width: 180px;
    cursor: pointer;
    transition: transform 0.15s ease, filter 0.15s ease;
    user-select: none;
    filter: drop-shadow(0 0 5px #9acd32);
    margin-bottom: 20px;
  }
  #wand:active {
    transform: scale(1.15) rotate(-5deg);
    filter: drop-shadow(0 0 15px #ffd700);
  }
  nav {
    margin-top: 10px;
    margin-bottom: 20px;
  }
  nav button {
    padding: 10px 25px;
    margin: 0 5px;
    font-size: 16px;
    background-color: #6a5acd;
    border: none;
    border-radius: 10px;
    color: white;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.3s ease;
  }
  nav button.active,
  nav button:hover {
    background-color: #7b68ee;
  }
  .tab {
    display: none;
    max-width: 550px;
    margin: 0 auto;
    background: rgba(0,0,0,0.6);
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 0 15px #000;
    text-align: left;
  }
  .tab.active {
    display: block;
  }
  #upgradesList div {
    margin-bottom: 15px;
    background: rgba(255, 255, 255, 0.1);
    padding: 12px;
    border-radius: 8px;
    box-shadow: inset 0 0 5px #000;
  }
  #upgradesList button {
    margin-top: 8px;
    width: 100%;
  }
  #leaderboardList {
    list-style: none;
    padding-left: 0;
    max-height: 200px;
    overflow-y: auto;
    text-align: left;
  }
  #leaderboardList li {
    margin-bottom: 8px;
    font-weight: bold;
    text-shadow: 1px 1px 2px #000;
  }
  #test {
    max-width: 600px;
    margin: 0 auto 30px auto;
    background: rgba(0,0,0,0.65);
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 0 15px #000;
    text-align: left;
  }
  #test h2 {
    text-align: center;
  }
  #test button {
    background-color: #6a5acd;
    color: white;
    border: none;
    padding: 8px 20px;
    margin-top: 15px;
    border-radius: 10px;
    cursor: pointer;
    display: block;
    width: 100%;
    font-size: 16px;
  }
  #test button:hover {
    background-color: #7b68ee;
  }
  #test label {
    display: block;
    margin: 8px 0;
    cursor: pointer;
  }
</style>
</head>
<body>

<h1>Хогвартс Кликер</h1>

<!-- Тест для выбора палочки -->
<div id="test">
  <h2>Тест: Какая палочка подходит тебе?</h2>
  <form id="testForm">
    <div>
      <p>1. Какое твое любимое магическое животное?</p>
      <label><input type="radio" name="q1" value="harry" required> Феникс</label>
      <label><input type="radio" name="q1" value="hermione"> Кот</label>
      <label><input type="radio" name="q1" value="ron"> Крыса</label>
      <label><input type="radio" name="q1" value="dumbledore"> Феникс</label>
      <label><input type="radio" name="q1" value="snape"> Змея</label>
      <label><input type="radio" name="q1" value="voldemort"> Змея</label>
      <label><input type="radio" name="q1" value="gryffindor"> Лев</label>
      <label><input type="radio" name="q1" value="ravenclaw"> Ворон</label>
      <label><input type="radio" name="q1" value="hufflepuff"> Барсук</label>
      <label><input type="radio" name="q1" value="slytherin"> Змея</label>
    </div>

    <div>
      <p>2. Какой твой стиль магии?</p>
      <label><input type="radio" name="q2" value="harry" required> Храбрый и решительный</label>
      <label><input type="radio" name="q2" value="hermione"> Умный и расчетливый</label>
      <label><input type="radio" name="q2" value="ron"> Верный и преданный</label>
      <label><input type="radio" name="q2" value="dumbledore"> Мудрый и могущественный</label>
      <label><input type="radio" name="q2" value="snape"> Таинственный и сильный</label>
      <label><input type="radio" name="q2" value="voldemort"> Темный и амбициозный</label>
      <label><input type="radio" name="q2" value="gryffindor"> Смелый и честный</label>
      <label><input type="radio" name="q2" value="ravenclaw"> Интеллектуальный и любознательный</label>
      <label><input type="radio" name="q2" value="hufflepuff"> Терпеливый и трудолюбивый</label>
      <label><input type="radio" name="q2" value="slytherin"> Лидер и стратег</label>
    </div>

    <div>
      <p>3. Какой твой любимый цвет?</p>
      <label><input type="radio" name="q3" value="harry" required> Красный</label>
      <label><input type="radio" name="q3" value="hermione"> Коричневый</label>
      <label><input type="radio" name="q3" value="ron"> Оранжевый</label>
      <label><input type="radio" name="q3" value="dumbledore"> Белый</label>
      <label><input type="radio" name="q3" value="snape"> Черный</label>
      <label><input type="radio" name="q3" value="voldemort"> Темно-зеленый</label>
      <label><input type="radio" name="q3" value="gryffindor"> Красный</label>
      <label><input type="radio" name="q3" value="ravenclaw"> Синий</label>
      <label><input type="radio" name="q3" value="hufflepuff"> Желтый</label>
      <label><input type="radio" name="q3" value="slytherin"> Зеленый</label>
    </div>

    <div>
      <p>4. Какое твое любимое заклинание?</p>
      <label><input type="radio" name="q4" value="harry" required> Экспекто Патронум</label>
      <label><input type="radio" name="q4" value="hermione"> Репаро</label>
      <label><input type="radio" name="q4" value="ron"> Вингардиум Левиоса</label>
      <label><input type="radio" name="q4" value="dumbledore"> Авада Кедавра</label>
      <label><input type="radio" name="q4" value="snape"> Окклюменция</label>
      <label><input type="radio" name="q4" value="voldemort"> Авада Кедавра</label>
      <label><input type="radio" name="q4" value="gryffindor"> Фириарис</label>
      <label><input type="radio" name="q4" value="ravenclaw"> Редукто</label>
      <label><input type="radio" name="q4" value="hufflepuff"> Ступефай</label>
      <label><input type="radio" name="q4" value="slytherin"> Империус</label>
    </div>

    <div>
      <p>5. Что для тебя важнее всего?</p>
      <label><input type="radio" name="q5" value="harry" required> Смелость</label>
      <label><input type="radio" name="q5" value="hermione"> Знания</label>
      <label><input type="radio" name="q5" value="ron"> Дружба</label>
      <label><input type="radio" name="q5" value="dumbledore"> Мудрость</label>
      <label><input type="radio" name="q5" value="snape"> Верность</label>
      <label><input type="radio" name="q5" value="voldemort"> Власть</label>
      <label><input type="radio" name="q5" value="gryffindor"> Честь</label>
      <label><input type="radio" name="q5" value="ravenclaw"> Логика</label>
      <label><input type="radio" name="q5" value="hufflepuff"> Терпение</label>
      <label><input type="radio" name="q5" value="slytherin"> Амбиции</label>
    </div>

    <button type="submit">Получить палочку</button>
  </form>
</div>

<!-- Основной интерфейс -->
<div id="gameArea" style="display:none;">
  <div id="counter">Галлеоны: 0</div>
  <img id="wand" src="images/wand_harry.jpeg" alt="Палочка" draggable="false" />
  <nav>
    <button class="tab-btn active" data-tab="game">Игра</button>
    <button class="tab-btn" data-tab="upgrades">Улучшения</button>
    <button class="tab-btn" data-tab="leaderboard">Рейтинг</button>
  </nav>

  <div id="game" class="tab active">
    <p>Нажимай на палочку, чтобы зарабатывать галлеоны!</p>
  </div>

  <div id="upgrades" class="tab">
    <h2>Улучшения</h2>
    <div id="upgradesList"></div>
  </div>

  <div id="leaderboard" class="tab">
    <h2>Рейтинг игроков</h2>
    <ul id="leaderboardList"></ul>
  </div>
</div>

<script>
  // Палочки: id, имя, картинка, описание
  const wands = {
    harry: {name:"Палочка Гарри Поттера", img:"images/wand_harry.jpeg", desc:"Оригинальная палочка Гарри Поттера, с сердцевиной из пера феникса."},
    hermione: {name:"Палочка Гермионы Грейнджер", img:"images/wand_hermione.jpeg", desc:"Палочка Гермионы, точная и надежная."},
    ron: {name:"Палочка Рона Уизли", img:"images/wand_ron.jpeg", desc:"Простая, но верная палочка Рона."},
    dumbledore: {name:"Палочка Альбуса Дамблдора", img:"images/wand_dumbledore.jpeg", desc:"Великая палочка — самая мощная из всех."},
    snape: {name:"Палочка Северуса Снэйпа", img:"images/wand_snape.jpeg", desc:"Тайная и мощная палочка."},
    voldemort: {name:"Палочка Волдеморта", img:"images/wand_voldemort.jpeg", desc:"Темная палочка с сердцевиной из пера змеи."},
    gryffindor: {name:"Палочка Гриффиндора", img:"images/wand_gryffindor.jpeg", desc:"Храбрая палочка рыцаря Гриффиндора."},
    ravenclaw: {name:"Палочка Когтеврана", img:"images/wand_ravenclaw.jpeg", desc:"Умная и изящная палочка."},
    hufflepuff: {name:"Палочка Пуффендуя", img:"images/wand_hufflepuff.jpeg", desc:"Терпеливая и надёжная палочка."},
    slytherin: {name:"Палочка Слизерина", img:"images/wand_slytherin.jpeg", desc:"Хитрая и мощная палочка."}
  };

  // Счётчик
  let clicks = 0;
  let clickPower = 1;
  let selectedWand = null;

  // Апгрейды
  let upgrades = [
    {id:'clickPower', name:'Сила клика', level:0, baseCost:5, costMult:1.5, desc:'Увеличивает галлеоны за клик на 1.'},
    {id:'autoClick', name:'Автоклик', level:0, baseCost:20, costMult:1.7, desc:'Автоматически зарабатывает галлеоны каждую секунду.'}
  ];

  // Локальный рейтинг (для примера)
  let leaderboard = [];

  // DOM элементы
  const counter = document.getElementById('counter');
  const wandImg = document.getElementById('wand');
  const tabs = document.querySelectorAll('.tab-btn');
  const tabContents = document.querySelectorAll('.tab');
  const upgradesList = document.getElementById('upgradesList');
  const leaderboardList = document.getElementById('leaderboardList');
  const testDiv = document.getElementById('test');
  const gameArea = document.getElementById('gameArea');
  const testForm = document.getElementById('testForm');

  // Функция обновления счёта
  function updateClicksDisplay() {
    counter.textContent = `Галлеоны: ${clicks.toFixed(0)}`;
  }

  // Обновить картинку палочки
  function updateWandImage() {
    if(selectedWand && wands[selectedWand]) {
      wandImg.src = wands[selectedWand].img;
      wandImg.alt = wands[selectedWand].name;
      wandImg.title = wands[selectedWand].desc;
    }
  }

  // Покупка апгрейда
  function buyUpgrade(id) {
    const upg = upgrades.find(u => u.id === id);
    if(!upg) return;
    const cost = Math.floor(upg.baseCost * Math.pow(upg.costMult, upg.level));
    if(clicks >= cost) {
      clicks -= cost;
      upg.level++;
      if(upg.id === 'clickPower') {
        clickPower = 1 + upg.level;
      }
      saveProgress();
      updateClicksDisplay();
      renderUpgrades();
    } else {
      alert('Недостаточно галлеонов!');
    }
  }

  // Автокликер
  setInterval(() => {
    const autoUpg = upgrades.find(u => u.id === 'autoClick');
    if(autoUpg && autoUpg.level > 0) {
      clicks += autoUpg.level;
      updateClicksDisplay();
      saveProgress();
    }
  }, 1000);

  // Отрисовка апгрейдов
  function renderUpgrades() {
    upgradesList.innerHTML = '';
    upgrades.forEach(upg => {
      const cost = Math.floor(upg.baseCost * Math.pow(upg.costMult, upg.level));
      const div = document.createElement('div');
      div.innerHTML = `<strong>${upg.name} (уровень: ${upg.level})</strong><br>${upg.desc}<br>Стоимость: ${cost} галлеонов`;
      const btn = document.createElement('button');
      btn.textContent = 'Купить';
      btn.onclick = () => buyUpgrade(upg.id);
      div.appendChild(btn);
      upgradesList.appendChild(div);
    });
  }

  // Отрисовка рейтинга
  function renderLeaderboard() {
    leaderboardList.innerHTML = '';
    if(leaderboard.length === 0) {
      leaderboardList.innerHTML = '<li>Пока нет игроков в рейтинге</li>';
      return;
    }
    leaderboard.sort((a,b) => b.score - a.score);
    leaderboard.slice(0,10).forEach((player, i) => {
      const li = document.createElement('li');
      li.textContent = `${i+1}. ${player.name}: ${player.score} галлеонов`;
      leaderboardList.appendChild(li);
    });
  }

  // Сохранение прогресса в localStorage
  function saveProgress() {
    localStorage.setItem('hpSave', JSON.stringify({
      clicks,
      selectedWand,
      upgrades
    }));
  }

  // Загрузка прогресса
  function loadProgress() {
    const saveData = JSON.parse(localStorage.getItem('hpSave'));
    if(saveData) {
      clicks = saveData.clicks || 0;
      selectedWand = saveData.selectedWand || null;
      if(saveData.upgrades) {
        upgrades.forEach(u => {
          const saved = saveData.upgrades.find(su => su.id === u.id);
          if(saved) u.level = saved.level || 0;
        });
      }
      if(selectedWand) {
        updateWandImage();
      }
      clickPower = 1 + (upgrades.find(u => u.id === 'clickPower')?.level || 0);
    }
  }

  // Обработка выбора палочки и начала игры
  testForm.onsubmit = (e) => {
    e.preventDefault();
    const formData = new FormData(testForm);
    const answers = {};
    for(let [key, value] of formData.entries()) {
      answers[key] = value;
    }
    // Подсчёт баллов по каждому варианту палочки
    const scores = {};
    for(let ans in answers) {
      scores[answers[ans]] = (scores[answers[ans]] || 0) + 1;
    }
    // Выбор палочки с максимальным количеством совпадений
    selectedWand = Object.keys(scores).reduce((a,b) => scores[a] > scores[b] ? a : b);
    updateWandImage();
    testDiv.style.display = 'none';
    gameArea.style.display = 'block';
    saveProgress();
    updateClicksDisplay();
    renderUpgrades();
    renderLeaderboard();
  };

  // Смена табов
  tabs.forEach(tab => {
    tab.onclick = () => {
      tabs.forEach(t => t.classList.remove('active'));
      tab.classList.add('active');
      const tabName = tab.dataset.tab;
      tabContents.forEach(tc => {
        tc.classList.toggle('active', tc.id === tabName);
      });
    };
  });

  // Клик по палочке
  wandImg.onclick = () => {
    clicks += clickPower;
    updateClicksDisplay();
    saveProgress();
  };

  // Загрузка прогресса при старте
  window.onload = () => {
    loadProgress();
    if(selectedWand) {
      testDiv.style.display = 'none';
      gameArea.style.display = 'block';
      updateClicksDisplay();
      renderUpgrades();
      renderLeaderboard();
    }
  };
</script>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f0f0f0;
    margin: 0; padding: 0;
    display: flex; justify-content: center; align-items: center; min-height: 100vh;
    flex-direction: column;
  }
  #test {
    background: white;
    padding: 20px;
    border-radius: 8px;
    max-width: 500px;
    width: 100%;
  }
  #test h2 {
    text-align: center;
  }
  #test div {
    margin-bottom: 15px;
  }
  label {
    display: block;
    margin-bottom: 6px;
    cursor: pointer;
  }
  button {
    cursor: pointer;
    padding: 8px 12px;
    background: #4caf50;
    border: none;
    color: white;
    border-radius: 4px;
    font-weight: bold;
  }
  button:hover {
    background: #45a049;
  }
  #gameArea {
    background: white;
    padding: 20px;
    border-radius: 8px;
    max-width: 600px;
    width: 100%;
  }
  #counter {
    font-size: 20px;
    margin-bottom: 10px;
  }
  img#wand {
    cursor: pointer;
    max-width: 100%;
    height: auto;
    display: block;
    margin: 0 auto 15px auto;
    user-select: none;
  }
  nav {
    display: flex;
    justify-content: center;
    margin-bottom: 15px;
  }
  .tab-btn {
    padding: 8px 16px;
    margin: 0 5px;
    border: 1px solid #4caf50;
    background: white;
    cursor: pointer;
    border-radius: 4px 4px 0 0;
    font-weight: bold;
  }
  .tab-btn.active {
    background: #4caf50;
    color: white;
  }
  .tab {
    display: none;
  }
  .tab.active {
    display: block;
  }
  #upgradesList div {
    margin-bottom: 10px;
    border-bottom: 1px solid #ddd;
    padding-bottom: 8px;
  }
  #leaderboardList {
    list-style: none;
    padding-left: 0;
  }
  #leaderboardList li {
    margin-bottom: 6px;
  }
</style>
</body>
