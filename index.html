<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Хогвартс: Магический Кликер</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=UnifrakturCook:wght@700&display=swap');

  body {
    font-family: 'UnifrakturCook', cursive;
    background: url('images/background.jpeg') no-repeat center center fixed;
    background-size: cover;
    color: #fff;
    text-align: center;
    margin: 0; padding: 0 20px 40px;
    user-select: none;
  }
  h1, h2 {
    text-shadow: 2px 2px 4px #000;
  }
  #game, #test, #upgrades, #leaderboard {
    display: none;
  }
  #test.active, #game.active, #upgrades.active, #leaderboard.active {
    display: block;
  }
  #counter {
    font-size: 24px;
    margin: 20px 0 10px;
    font-weight: bold;
    text-shadow: 1px 1px 2px black;
  }
  #wand {
    width: 150px;
    cursor: pointer;
    user-select: none;
    margin: 20px auto 10px;
    border-radius: 15px;
    box-shadow:
      0 0 10px 3px rgba(255, 215, 0, 0.7),
      0 0 20px 6px rgba(255, 215, 0, 0.4);
    filter: drop-shadow(0 0 4px gold);
    animation: glowPulse 3s infinite alternate ease-in-out;
    transition: transform 0.15s ease;
    display: block;
  }
  #wand:active {
    transform: scale(1.2) rotate(-5deg);
    animation-play-state: paused;
    box-shadow:
      0 0 20px 6px rgba(255, 255, 224, 1),
      0 0 30px 12px rgba(255, 255, 224, 0.8);
    filter: drop-shadow(0 0 10px #fffacd);
  }
  @keyframes glowPulse {
    0% {
      box-shadow:
        0 0 10px 3px rgba(255, 215, 0, 0.7),
        0 0 20px 6px rgba(255, 215, 0, 0.4);
    }
    100% {
      box-shadow:
        0 0 20px 8px rgba(255, 215, 0, 1),
        0 0 30px 14px rgba(255, 215, 0, 0.7);
    }
  }
  button {
    padding: 10px 20px;
    margin: 10px 5px 0;
    font-size: 18px;
    background-color: #6a5acd;
    border: none;
    border-radius: 10px;
    color: white;
    cursor: pointer;
    user-select: none;
    text-shadow: 1px 1px 2px black;
    transition: background-color 0.3s;
  }
  button:hover {
    background-color: #7b68ee;
  }
  #nav {
    margin-top: 10px;
  }
  .question {
    font-size: 20px;
    margin: 20px 0 10px;
  }
  .answers button {
    display: block;
    margin: 8px auto;
    width: 60%;
  }
  #upgrade-list button {
    display: block;
    width: 60%;
    margin: 10px auto;
  }
  #leaderboard-list {
    margin-top: 10px;
    max-height: 200px;
    overflow-y: auto;
    background: rgba(0,0,0,0.4);
    border-radius: 8px;
    padding: 10px;
  }
  #leaderboard-list div {
    padding: 5px;
    border-bottom: 1px solid rgba(255,255,255,0.2);
  }
</style>
</head>
<body>

<h1>Хогвартс: Магический Кликер</h1>

<div id="test" class="active">
  <h2>Пройди тест и получи свою палочку</h2>
  <div id="question-container"></div>
</div>

<div id="game">
  <h2>Твой магический кликер</h2>
  <div id="counter">Галлеонов: 0</div>
  <img id="wand" src="" alt="Палочка" />
  <div id="nav">
    <button onclick="showSection('upgrades')">Улучшения</button>
    <button onclick="showSection('leaderboard')">Рейтинг</button>
  </div>
</div>

<div id="upgrades">
  <h2>Улучшения</h2>
  <div id="upgrade-list"></div>
  <button onclick="showSection('game')">Назад в игру</button>
</div>

<div id="leaderboard">
  <h2>Рейтинг игроков</h2>
  <div id="leaderboard-list">
    <div>1. Волдеморт — 5000 галлеонов</div>
    <div>2. Гарри Поттер — 4000 галлеонов</div>
    <div>3. Гермиона — 3500 галлеонов</div>
    <div>4. Рон — 3200 галлеонов</div>
  </div>
  <button onclick="showSection('game')">Назад в игру</button>
</div>

<script>
  // Палочки героев (название, картинка jpeg в images)
  const wands = [
    {name: "Палочка Гарри Поттера", img: "images/harry.jpeg"},
    {name: "Палочка Гермионы", img: "images/hermione.jpeg"},
    {name: "Палочка Рона", img: "images/ron.jpeg"},
    {name: "Палочка Волдеморта", img: "images/voldemort.jpeg"},
    {name: "Палочка Дамблдора", img: "images/dumbledore.jpeg"},
    {name: "Палочка Снейпа", img: "images/snape.jpeg"},
    {name: "Палочка Лунной Лавгуд", img: "images/luna.jpeg"},
    {name: "Палочка Невилла", img: "images/neville.jpeg"},
    {name: "Палочка Макгонагалл", img: "images/mcgonagall.jpeg"},
    {name: "Палочка Фреда и Джорджа", img: "images/fredgeorge.jpeg"}
  ];

  // Тестовые вопросы и ответы
  const questions = [
    {
      question: "Какой факультет Хогвартса тебе ближе?",
      answers: [
        {text: "Гриффиндор", wandIndex: 0},
        {text: "Когтевран", wandIndex: 1},
        {text: "Пуффендуй", wandIndex: 2},
        {text: "Слизерин", wandIndex: 3},
      ]
    },
    {
      question: "Какой магический предмет ты бы выбрал?",
      answers: [
        {text: "Мантия-невидимка", wandIndex: 0},
        {text: "Карта Мародёров", wandIndex: 4},
        {text: "Зелье Полета", wandIndex: 5},
        {text: "Шляпа Распределения", wandIndex: 6},
      ]
    },
    {
      question: "Какое твое любимое магическое существо?",
      answers: [
        {text: "Феникс", wandIndex: 4},
        {text: "Хиппогриф", wandIndex: 7},
        {text: "Кентавр", wandIndex: 8},
        {text: "Домовой эльф", wandIndex: 9},
      ]
    },
    {
      question: "Какую магическую способность ты бы хотел иметь?",
      answers: [
        {text: "Невидимость", wandIndex: 0},
        {text: "Левитация", wandIndex: 1},
        {text: "Зачарование", wandIndex: 2},
        {text: "Заклинания защиты", wandIndex: 3},
      ]
    },
    {
      question: "Твое любимое волшебное заклинание?",
      answers: [
        {text: "Экспекто Патронум", wandIndex: 0},
        {text: "Авада Кедавра", wandIndex: 3},
        {text: "Вингардиум Левиоса", wandIndex: 1},
        {text: "Люмос", wandIndex: 4},
      ]
    }
  ];

  let currentQuestionIndex = 0;
  let answersCount = {};
  let selectedWandIndex = 0;

  function showSection(sectionId) {
    ['test','game','upgrades','leaderboard'].forEach(id => {
      document.getElementById(id).classList.remove('active');
    });
    document.getElementById(sectionId).classList.add('active');
  }

  function renderQuestion() {
    const container = document.getElementById('question-container');
    const q = questions[currentQuestionIndex];
    container.innerHTML = `<div class="question">${q.question}</div><div class="answers"></div>`;
    const answersDiv = container.querySelector('.answers');
    q.answers.forEach(a => {
      const btn = document.createElement('button');
      btn.textContent = a.text;
      btn.onclick = () => {
        answersCount[a.wandIndex] = (answersCount[a.wandIndex] || 0) + 1;
        currentQuestionIndex++;
        if(currentQuestionIndex < questions.length) {
          renderQuestion();
        } else {
          selectWandByAnswers();
          startGame();
        }
      };
      answersDiv.appendChild(btn);
    });
  }

  function selectWandByAnswers() {
    // Найти wandIndex с наибольшим кол-вом ответов
    let maxCount = -1;
    for (const k in answersCount) {
      if(answersCount[k] > maxCount) {
        maxCount = answersCount[k];
        selectedWandIndex = Number(k);
      }
    }
  }

  // Игра
  let galleons = 0;
  let upgradeCost = 10;
  let upgradeLevel = 0;

  function saveProgress() {
    localStorage.setItem('galleons', galleons);
    localStorage.setItem('selectedWandIndex', selectedWandIndex);
    localStorage.setItem('upgradeLevel', upgradeLevel);
  }
  function loadProgress() {
    const savedGalleons = localStorage.getItem('galleons');
    const savedWand = localStorage.getItem('selectedWandIndex');
    const savedUpgrade = localStorage.getItem('upgradeLevel');
    if(savedGalleons !== null) galleons = parseInt(savedGalleons);
    if(savedWand !== null) selectedWandIndex = parseInt(savedWand);
    if(savedUpgrade !== null) upgradeLevel = parseInt(savedUpgrade);
  }

  function startGame() {
    loadProgress();
    showSection('game');
    updateWand();
    updateCounter();
    renderUpgrades();
  }

  function updateWand() {
    const wandImg = document.getElementById('wand');
    wandImg.src = wands[selectedWandIndex].img;
    wandImg.alt = wands[selectedWandIndex].name;
  }

  function updateCounter() {
    document.getElementById('counter').textContent = `Галлеонов: ${galleons}`;
  }

  document.getElementById('wand').onclick = () => {
    galleons += (1 + upgradeLevel);
    updateCounter();
    saveProgress();
  };

  // Улучшения
  function renderUpgrades() {
    const container = document.getElementById('upgrade-list');
    container.innerHTML = '';
    const upgradeBtn = document.createElement('button');
    upgradeBtn.textContent = `Улучшить палочку (+1 галлеон за клик) — Стоимость: ${upgradeCost}`;
    upgradeBtn.onclick = () => {
      if(galleons >= upgradeCost) {
        galleons -= upgradeCost;
        upgradeLevel++;
        upgradeCost = Math.floor(upgradeCost * 1.7);
        updateCounter();
        renderUpgrades();
        saveProgress();
      } else {
        alert('Недостаточно галлеонов');
      }
    };
    container.appendChild(upgradeBtn);
  }

  // Инициализация
  renderQuestion();

</script>

</body>
</html>
